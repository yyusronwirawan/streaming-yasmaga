import{r as o,b as e,j as r,a as x,S as C}from"./main-0ef92fc4.js";const U=()=>{const[i,v]=o.useState(null),[p,f]=o.useState(new FormData),[m,w]=o.useState(!0),[N,F]=o.useState(null),[u,b]=o.useState(null),[g,k]=o.useState("");o.useEffect(()=>{(async()=>{try{const t=await x.get("/api/auth-check");t.data.authenticated?(v(t.data.user),b(t.data.user.image),f(c=>{const a=new FormData;for(const[n,s]of c.entries())a.append(n,s);return a.set("full_name",t.data.user.full_name),a.set("username",t.data.user.username),a.set("email",t.data.user.email),a})):window.location.href="/login"}catch{F("Failed to fetch user data.")}finally{w(!1)}})()},[]);const h=l=>{const{name:t,value:c,files:a}=l.target,n=new FormData;for(const[s,d]of p.entries())n.append(s,d);if(a&&a.length>0){n.set(t,a[0]);const s=a[0],d=URL.createObjectURL(s);b(d)}else n.set(t,c);f(n)},S=l=>{k(l.target.value)},y=async l=>{var t,c;if(l.preventDefault(),!!i)try{w(!0),g&&p.set("password",g),await x.post(`/api/users/${i.id}/update`,p,{headers:{"Content-Type":"multipart/form-data"}}),await C.fire({icon:"success",title:"Success",text:"User updated successfully!",timer:3e3,confirmButtonColor:"#3085d6"});const a=await x.get("/api/auth-check");v(a.data.user),b(a.data.user.image),f(n=>{const s=new FormData;for(const[d,D]of n.entries())s.append(d,D);return s.set("full_name",a.data.user.full_name),s.set("username",a.data.user.username),s.set("email",a.data.user.email),s})}catch(a){await C.fire({icon:"error",title:"Error",text:((c=(t=a.response)==null?void 0:t.data)==null?void 0:c.message)||"Could not update the user. Please try again.",timer:3e3,confirmButtonColor:"#3085d6"})}finally{k(""),w(!1)}};return m?e("div",{children:"Loading..."}):N?e("div",{className:"text-red-600",children:N}):r("div",{className:"p-4 flex flex-col overflow-hidden",children:[e("nav",{className:"text-gray-500 mb-4","aria-label":"Breadcrumb",children:r("ol",{className:"flex text-gray-500 font-semibold dark:text-white-dark",children:[e("li",{children:e("button",{className:"hover:text-gray-500/70 dark:hover:text-white-dark/70",children:r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",children:[e("circle",{cx:"12",cy:"6",r:"4",stroke:"currentColor",strokeWidth:"1.5"}),e("path",{opacity:"0.5",d:"M20 17.5C20 19.9853 20 22 12 22C4 22 4 19.9853 4 17.5C4 15.0147 7.58172 13 12 13C16.4183 13 20 15.0147 20 17.5Z",stroke:"currentColor",strokeWidth:"1.5"})]})})}),e("li",{className:"before:content-['/'] before:px-1.5",children:e("button",{type:"button",children:"Setting Profil"})})]})}),e("div",{className:"container mx-auto",children:i&&r("form",{onSubmit:y,className:"p-6 rounded shadow-md panel border border-white-light dark:border-[#1b2e4b]",children:[e("h2",{className:"text-2xl font-bold mb-1",children:"Profil Saya"}),e("h2",{className:"mb-3 text-gray-500",children:"Kelola informasi profil anda untuk, mengontrol, melindungi dan mengamankan akun"}),e("div",{className:"mb-4",children:r("div",{className:"flex items-center space-x-4",children:[u&&e("div",{className:"mt-2",children:e("img",{src:i.image!==null&&!u.includes("blob")?`/storage/${u}`:u,alt:"Image Preview",className:"w-32 h-32 object-cover rounded"})}),e("input",{type:"file",name:"image",id:"image",onChange:h,className:"hidden"}),r("button",{type:"button",onClick:()=>{var l;return(l=document.getElementById("image"))==null?void 0:l.click()},className:"relative flex items-center justify-center bg-white border border-blue-600 text-blue-600 hover:text-white font-bold py-2 px-4 rounded group overflow-hidden",children:[e("span",{className:"absolute inset-0 bg-blue-700 transform -translate-x-full group-hover:translate-x-0 transition duration-300 ease-in-out"}),r("span",{className:"relative z-10 flex items-center",children:[e("svg",{height:"24px",width:"24px",version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 312.602 312.602",xmlSpace:"preserve",className:"mr-2","aria-hidden":"true",children:e("path",{className:"fill-blue-600 group-hover:fill-white transition-colors duration-300",d:`M251.52,137.244c-3.966,0-7.889,0.38-11.738,1.134c-1.756-47.268-40.758-85.181-88.448-85.181
                                            c-43.856,0-80.964,32.449-87.474,75.106C28.501,129.167,0,158.201,0,193.764c0,36.106,29.374,65.48,65.48,65.48h54.782
                                            c4.143,0,7.5-3.357,7.5-7.5c0-4.143-3.357-7.5-7.5-7.5H65.48c-27.835,0-50.48-22.645-50.48-50.48c0-27.835,22.646-50.48,50.48-50.48
                                            c1.367,0,2.813,0.067,4.419,0.206l7.6,0.658l0.529-7.61c2.661-38.322,34.861-68.341,73.306-68.341
                                            c40.533,0,73.51,32.977,73.51,73.51c0,1.863-0.089,3.855-0.272,6.088l-0.983,11.968l11.186-4.367
                                            c5.356-2.091,10.99-3.151,16.747-3.151c25.409,0,46.081,20.672,46.081,46.081c0,25.408-20.672,46.08-46.081,46.08
                                            c-0.668,0-20.608-0.04-40.467-0.08c-19.714-0.04-39.347-0.08-39.999-0.08c-4.668,0-7.108-2.248-7.254-6.681v-80.959l8.139,9.667
                                            c2.667,3.17,7.399,3.576,10.567,0.907c3.169-2.667,3.575-7.398,0.907-10.567l-18.037-21.427c-2.272-2.699-5.537-4.247-8.958-4.247
                                            c-3.421,0-6.686,1.548-8.957,4.247l-18.037,21.427c-2.668,3.169-2.262,7.9,0.907,10.567c1.407,1.185,3.121,1.763,4.826,1.763
                                            c2.137,0,4.258-0.908,5.741-2.67l7.901-9.386v80.751c0,8.686,5.927,21.607,22.254,21.607c0.652,0,20.27,0.04,39.968,0.079
                                            c19.874,0.041,39.829,0.081,40.498,0.081c33.681,0,61.081-27.4,61.081-61.08C312.602,164.644,285.201,137.244,251.52,137.244z`})}),"Upload"]})]})]})}),e("hr",{className:"border-white-light dark:border-[#1b2e4b]"}),r("div",{className:"flex items-center space-x-4 mb-4 mt-5",children:[e("label",{className:"w-1/4",htmlFor:"full_name",children:"Nama Lengkap"}),e("input",{type:"text",name:"full_name",id:"full_name",defaultValue:i.full_name,onChange:h,placeholder:"Masukkan Nama Lengkap",className:"w-3/4 form-input",required:!0})]}),r("div",{className:"flex items-center space-x-4 mb-4",children:[e("label",{className:"w-1/4",htmlFor:"username",children:"Username"}),e("input",{type:"text",name:"username",id:"username",defaultValue:i.username,onChange:h,placeholder:"Masukkan Username",className:"w-3/4 form-input",required:!0})]}),r("div",{className:"flex items-center space-x-4 mb-4",children:[e("label",{className:"w-1/4",htmlFor:"email",children:"Email"}),e("input",{type:"email",name:"email",id:"email",defaultValue:i.email,onChange:h,placeholder:"Masukkan Email",className:"w-3/4 form-input",required:!0})]}),r("div",{className:"flex items-center space-x-4",children:[e("label",{className:"w-1/4",htmlFor:"password",children:"Password"}),e("input",{type:"password",name:"password",id:"password",value:g,onChange:S,placeholder:"Masukkan Password",className:"w-3/4 form-input",required:!0})]}),r("div",{className:"flex items-center space-x-4 mb-4",children:[e("label",{className:"w-1/4",htmlFor:"password"}),e("div",{className:"w-3/4",children:e("p",{className:"text-red-600",children:"*Biarkan kosong apabila tidak ada perubahan password"})})]}),r("div",{className:"flex items-center space-x-4",children:[e("label",{className:"w-1/4"}),e("div",{className:"w-3/4",children:e("button",{type:"button",onClick:y,className:`px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md transition duration-200 ease-in-out
                            ${m?"opacity-70 cursor-not-allowed":"hover:bg-blue-700"}`,disabled:m,children:m?"Mengubah...":"Perbarui"})})]})]})})]})};export{U as default};
