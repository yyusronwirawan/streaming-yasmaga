import{r as l,a as d,j as r,b as e,R as m,S as s}from"./main-0ef92fc4.js";import{H as j,a as R,b as z,c as W}from"./index-8e00322f.js";import{z as v,y as B}from"./dialog-b10a86f8.js";const U=()=>{const[N,u]=l.useState(()=>{const t=new URL(window.location.href);return t.pathname="/api/promos",t.toString()}),[a,M]=l.useState(null),[p,P]=l.useState(null),[k,f]=l.useState(!1),[x,b]=l.useState(!1),[C,S]=l.useState(null),[g,y]=l.useState({name:"",phone:""});l.useEffect(()=>{(async()=>{if(!(await d.get("/api/auth-check")).data.authenticated){window.location.href="/login";return}})(),L()},[N]);const L=async()=>{try{const t=await d.get(N);M(t.data)}catch(t){console.error("Error fetching promos:",t)}},E=t=>{P(p===t?null:t)},w=()=>{f(!1),b(!1),S(null),y({name:"",phone:""})},T=t=>{const{name:o,value:n}=t.target;y(i=>({...i,[o]:n}))},H=async t=>{t.preventDefault();const{name:o,phone:n}=g,i={name:o,phone:n};try{const c=new FormData;if(Object.keys(i).forEach(h=>{c.append(h,i[h])}),x&&C)try{await d.post(`/api/promos/${C.id}/update`,c),await s.fire({icon:"success",title:"Success",text:"Data promosi berhasil diupdate!",timer:2e3,confirmButtonColor:"#3085d6"})}catch{await s.fire({icon:"error",title:"Error",text:"Tidak dapat mengupdate data promosi. Harap coba lagi.",timer:2e3,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"})}else try{await d.post("/api/promos",c),await s.fire({icon:"success",title:"Success",text:"Data promosi berhasil dibuat!",timer:2e3,confirmButtonColor:"#3085d6"})}catch{await s.fire({icon:"error",title:"Error",text:"Tidak dapat menyimpan data promosi. Harap coba lagi.",timer:2e3,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"})}L(),w()}catch(c){console.error("Error saving user:",c)}},D=t=>{S(t),y({name:t.name,phone:t.phone}),b(!0),f(!0)},F=async t=>{if((await s.fire({title:"Anda yakin?",text:"Kamu tidak akan bisa membatalkan ini!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus!",cancelButtonText:"Tidak",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"})).isConfirmed)try{await d.delete(`/api/promos/${t}`),u(n=>{const i=new URL(n);return i.searchParams.set("page","1"),i.toString()}),await s.fire({icon:"success",title:"Deleted!",text:"Data promosi berhasil dihapus.",timer:2e3,confirmButtonColor:"#3085d6"})}catch(n){console.error("Error deleting promo:",n),await s.fire({icon:"error",title:"Error",text:"Tidak bisa menghapus data promosi. Harap coba lagi.",timer:2e3,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"})}};return r("div",{className:"p-4 flex flex-col overflow-hidden",children:[e("nav",{className:"text-gray-500 mb-4","aria-label":"Breadcrumb",children:r("ol",{className:"flex text-gray-500 font-semibold dark:text-white-dark",children:[e("li",{children:e("button",{className:"hover:text-gray-500/70 dark:hover:text-white-dark/70",children:r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",children:[e("path",{d:"M18.18 8.03933L18.6435 7.57589C19.4113 6.80804 20.6563 6.80804 21.4241 7.57589C22.192 8.34374 22.192 9.58868 21.4241 10.3565L20.9607 10.82M18.18 8.03933C18.18 8.03933 18.238 9.02414 19.1069 9.89309C19.9759 10.762 20.9607 10.82 20.9607 10.82M18.18 8.03933L13.9194 12.2999C13.6308 12.5885 13.4865 12.7328 13.3624 12.8919C13.2161 13.0796 13.0906 13.2827 12.9882 13.4975C12.9014 13.6797 12.8368 13.8732 12.7078 14.2604L12.2946 15.5L12.1609 15.901M20.9607 10.82L16.7001 15.0806C16.4115 15.3692 16.2672 15.5135 16.1081 15.6376C15.9204 15.7839 15.7173 15.9094 15.5025 16.0118C15.3203 16.0986 15.1268 16.1632 14.7396 16.2922L13.5 16.7054L13.099 16.8391M13.099 16.8391L12.6979 16.9728C12.5074 17.0363 12.2973 16.9867 12.1553 16.8447C12.0133 16.7027 11.9637 16.4926 12.0272 16.3021L12.1609 15.901M13.099 16.8391L12.1609 15.901",stroke:"currentColor",strokeWidth:"1.5"}),e("path",{d:"M8 13H10.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e("path",{d:"M8 9H14.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e("path",{d:"M8 17H9.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e("path",{opacity:"0.5",d:"M3 10C3 6.22876 3 4.34315 4.17157 3.17157C5.34315 2 7.22876 2 11 2H13C16.7712 2 18.6569 2 19.8284 3.17157C21 4.34315 21 6.22876 21 10V14C21 17.7712 21 19.6569 19.8284 20.8284C18.6569 22 16.7712 22 13 22H11C7.22876 22 5.34315 22 4.17157 20.8284C3 19.6569 3 17.7712 3 14V10Z",stroke:"currentColor",strokeWidth:"1.5"})]})})}),e("li",{className:"before:content-['/'] before:px-1.5",children:e("button",{type:"button",children:"Data Promosi"})})]})}),r("div",{className:"container mx-auto py-1 px-4 sm:px-0",children:[e("button",{className:"flex items-center justify-center mb-2 px-2 py-2 text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200 ease-in-out",onClick:()=>{b(!1),f(!0)},children:"Tambah Promosi"}),e("div",{className:"overflow-x-auto shadow-md rounded-lg border border-white-light/40 dark:border-[#191e3a]",children:r("table",{className:"min-w-full table-auto table-hover",children:[e("thead",{children:r("tr",{children:[e("th",{className:"py-3 px-4 text-left",children:"No"}),e("th",{className:"py-3 px-4 text-left",children:"Nama Kota"}),e("th",{className:"py-3 px-4 text-left hidden sm:table-cell",children:"Nomor Telepon"}),e("th",{className:"py-3 px-4 text-left",children:"Aksi"})]})}),e("tbody",{className:"divide-y divide-gray-200",children:!(a!=null&&a.data)||a.data.length===0?e("tr",{children:e("td",{colSpan:4,className:"py-4 text-center text-gray-500",children:"Tidak ada data promosi."})}):a.data.map((t,o)=>r(m.Fragment,{children:[r("tr",{children:[e("td",{className:"py-2 px-4",children:o+1}),e("td",{className:"py-2 px-4",children:t.name}),e("td",{className:"py-2 px-4 hidden sm:table-cell",children:t.phone}),r("td",{className:"py-4 px-4 flex items-center space-x-2",children:[e("button",{onClick:()=>D(t),className:"text-blue-600 hover:text-blue-800 focus:outline-none",children:e(j,{size:20})}),e("button",{onClick:()=>F(t.id),className:"text-red-600 hover:text-red-800 focus:outline-none",children:e(R,{size:20})}),e("div",{className:"lg:hidden mt-2",children:e("button",{onClick:()=>E(o),className:"text-gray-600 hover:text-gray-800 focus:outline-none",children:p===o?e(z,{size:20}):e(W,{size:20})})})]})]}),p===o&&e("tr",{children:e("td",{colSpan:4,className:"py-3 px-4 lg:hidden",children:e("div",{className:"flex flex-col space-y-2",children:e("div",{className:"block sm:hidden md:hidden",children:r("p",{children:["Nomor Telepon: ",t.phone]})})})})})]},t.id))})]})}),r("div",{className:"flex flex-col sm:flex-row items-center sm:justify-between gap-4 mt-2",children:[r("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[r("span",{children:["Showing ",a==null?void 0:a.from," to ",a==null?void 0:a.to," of ",a==null?void 0:a.total," entries"]}),r("select",{className:"form-select form-select-sm text-white-dark w-auto pr-6",value:a==null?void 0:a.per_page,onChange:t=>u(o=>{const n=new URL(o);return n.searchParams.set("per_page",t.target.value),n.searchParams.set("page","1"),n.toString()}),children:[e("option",{value:"10",children:"10"}),e("option",{value:"25",children:"25"}),e("option",{value:"50",children:"50"}),e("option",{value:"100",children:"100"})]})]}),e("ul",{className:"flex items-center space-x-1 rtl:space-x-reverse",children:a==null?void 0:a.links.map((t,o)=>e("li",{children:e("button",{type:"button",onClick:()=>t.url&&u(t.url),className:`flex justify-center font-semibold px-3.5 py-2 rounded-full transition ${t.active?"bg-primary text-white dark:text-white-light dark:bg-primary":"bg-white-light text-dark hover:text-white hover:bg-primary dark:text-white-light dark:bg-[#191e3a] dark:hover:bg-primary"}`,dangerouslySetInnerHTML:{__html:t.label}})},o))})]}),e(v,{appear:!0,show:k,as:m.Fragment,children:r(B,{as:"div",open:k,onClose:w,children:[e(v.Child,{as:m.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0"})}),e("div",{className:"fixed inset-0 z-[999] overflow-y-auto bg-[black]/60",children:e("div",{className:"flex min-h-screen items-center justify-center px-4",children:e(v.Child,{as:m.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:r(B.Panel,{as:"div",className:"panel my-8 w-full max-w-lg overflow-hidden rounded-lg border-0 p-0 text-black dark:text-white-dark",children:[e("div",{className:"flex items-center justify-between bg-[#fbfbfb] px-5 py-3 dark:bg-[#121c2c]",children:e("h5",{className:"text-lg font-bold",children:x?"Edit Promo":"Tambah Promosi"})}),r("form",{onSubmit:H,className:"p-4 text-sm",children:[r("div",{className:"mb-4",children:[e("label",{htmlFor:"name",children:"Nama Kota"}),e("input",{type:"text",name:"name",id:"name",value:g.name,onChange:T,placeholder:"Masukkan Nama Kota",required:!0,className:"form-input"})]}),r("div",{className:"mb-4",children:[e("label",{htmlFor:"phone",children:"Nomor Telepon"}),e("input",{type:"number",name:"phone",id:"phone",value:g.phone,onChange:T,placeholder:"Masukkan Nomor Telepon",required:!0,className:"form-input"})]}),r("div",{className:"flex justify-end",children:[e("button",{type:"button",className:"mr-2 px-4 py-2 text-gray-600 bg-gray-200 rounded-md",onClick:w,children:"Batal"}),e("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700",children:x?"Simpan Perubahan":"Simpan"})]})]})]})})})})]})})]})]})};export{U as default};
