import{r as u,a as y,j as n,b as e,R as v,S as g}from"./main-0ef92fc4.js";import{H as q,a as A,b as Y,c as G}from"./index-8e00322f.js";import{z as T,y as L}from"./dialog-b10a86f8.js";const ee=()=>{const[B,w]=u.useState(()=>{const t=new URL(window.location.href);return t.pathname="/api/schedules",t.toString()}),[s,M]=u.useState(null),[N,J]=u.useState(null),[E,C]=u.useState(!1),[c,k]=u.useState(!1),[H,_]=u.useState(null),[d,m]=u.useState({name:"",date:"",time:"",created_by:"",updated_by:"",description:"",image:null});u.useEffect(()=>{(async()=>{if(!(await y.get("/api/auth-check")).data.authenticated){window.location.href="/login";return}})(),D()},[B]);const D=async()=>{try{const t=await y.get(B);M(t.data)}catch(t){console.error("Error fetching schedules:",t)}},R=t=>{J(N===t?null:t)},S=()=>{C(!1),k(!1),_(null),m({name:"",date:"",time:"",created_by:"",updated_by:"",description:"",image:null})},W=t=>{const{name:a,value:l}=t.target;m(r=>({...r,[a]:l}))},I=t=>{m({...d,[t.target.name]:t.target.value})},F=t=>{if(t.key==="Backspace"){const a=t.target,l=a.value;l.endsWith(":")&&l.length===3&&(a.value=l.slice(0,-2),t.preventDefault())}},j=t=>{const{name:a}=t.target,{value:l}=t.target;let r=l.replace(/[^0-9:]/g,"");if(c){r.length===2&&!r.includes(":")&&(r+=":");const i=r.split(":");i.length>2?r=r.slice(0,-1):i[0].length>2||i[0].length===2&&parseInt(i[0])>23?r=i[0].slice(0,2):i[1]&&(i[1].length>2||i[1].length===2&&parseInt(i[1])>59)&&(r=r.slice(0,-1)),m(p=>{const[x,f]=p.time.split(" - ").map(b=>b.trim());let h=x,o=f;return a==="startTime"?h=r:a==="endTime"&&(o=r),{...p,time:`${h||""} - ${o||""}`.trim()}})}else{if(r.length===2&&!r.includes(":")){t.target.value=r+":";return}const i=r.split(":");if(i.length>2){t.target.value=r.slice(0,-1);return}if(i[0].length>2||i[0].length===2&&parseInt(i[0])>23){t.target.value=i[0].slice(0,2);return}if(i[1]&&(i[1].length>2||i[1].length===2&&parseInt(i[1])>59)){t.target.value=r.slice(0,-1);return}t.target.value=r,m(p=>{const[x,f]=p.time.split(" - ");let h=x,o=f;return a==="startTime"?h=l||r:a==="endTime"&&(o=l||r),{...p,time:`${h} - ${o}`}})}},P=t=>{const a=t.target,l=a.value;l.length===1?a.value=l+"0:00":l.length===3&&l.endsWith(":")?a.value=l+"00":l.length===4&&l[2]===":"&&(a.value=l+"0")},$=()=>{if(d.time&&c){const[t]=d.time.split("-").map(a=>a.trim());return t}else return""},z=()=>{if(d.time){const t=d.time.split("-").map(a=>a.trim());return t.length>1?t[1]:""}else return""},O=t=>{const a=t.target.files;a&&a.length>0?m(l=>({...l,image:a[0]})):m(l=>({...l,image:null}))},K=async t=>{t.preventDefault();const{name:a,date:l,time:r,created_by:i,updated_by:p,description:x,image:f}=d,h={name:a,date:l,time:r,created_by:i,updated_by:p,description:x};try{const o=new FormData;if(Object.keys(h).forEach(b=>{o.append(b,h[b])}),f&&o.append("image",f),c&&H)try{await y.post(`/api/schedules/${H.id}/update`,o),await g.fire({icon:"success",title:"Success",text:"Schedule updated successfully!",timer:2e3,confirmButtonColor:"#3085d6"})}catch{await g.fire({icon:"error",title:"Error",text:"Could not update the schedule. Please try again.",timer:2e3,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"})}else try{await y.post("/api/schedules",o),await g.fire({icon:"success",title:"Success",text:"Schedule created successfully!",timer:2e3,confirmButtonColor:"#3085d6"})}catch{await g.fire({icon:"error",title:"Error",text:"Could not save schedule. Please try again.",timer:2e3,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"})}D(),S()}catch(o){console.error("Error saving schedule:",o)}},U=t=>{_(t),m({name:t.name,date:t.date,time:t.time,created_by:t.created_by,updated_by:t.updated_by,description:t.description,image:null}),k(!0),C(!0)},V=async t=>{if((await g.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"})).isConfirmed)try{await y.delete(`/api/schedules/${t}`),w(l=>{const r=new URL(l);return r.searchParams.set("page","1"),r.toString()}),await g.fire({icon:"success",title:"Deleted!",text:"Your schedule has been deleted.",timer:2e3,confirmButtonColor:"#3085d6"})}catch(l){console.error("Error deleting schedule:",l),await g.fire({icon:"error",title:"Error",text:"Could not delete schedule. Please try again.",timer:2e3,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"})}};return n("div",{className:"p-4 flex flex-col overflow-hidden",children:[e("nav",{className:"text-gray-500 mb-4","aria-label":"Breadcrumb",children:n("ol",{className:"flex text-gray-500 font-semibold dark:text-white-dark",children:[e("li",{children:e("button",{className:"hover:text-gray-500/70 dark:hover:text-white-dark/70",children:n("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",children:[e("path",{d:"M2 12C2 8.22876 2 6.34315 3.17157 5.17157C4.34315 4 6.22876 4 10 4H14C17.7712 4 19.6569 4 20.8284 5.17157C22 6.34315 22 8.22876 22 12V14C22 17.7712 22 19.6569 20.8284 20.8284C19.6569 22 17.7712 22 14 22H10C6.22876 22 4.34315 22 3.17157 20.8284C2 19.6569 2 17.7712 2 14V12Z",stroke:"currentColor",strokeWidth:"1.5"}),e("path",{opacity:"0.5",d:"M7 4V2.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e("path",{opacity:"0.5",d:"M17 4V2.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e("path",{opacity:"0.5",d:"M2 9H22",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})})}),e("li",{className:"before:content-['/'] before:px-1.5",children:e("button",{type:"button",children:"Data Jadwal"})})]})}),n("div",{className:"container mx-auto py-1 px-4 sm:px-0",children:[e("button",{className:"flex items-center justify-center mb-2 px-2 py-2 text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200 ease-in-out",onClick:()=>{k(!1),C(!0)},children:"Tambah Jadwal"}),e("div",{className:"overflow-x-auto shadow-md rounded-lg border border-white-light/40 dark:border-[#191e3a]",children:n("table",{className:"min-w-full table-auto table-hover",children:[e("thead",{children:n("tr",{children:[e("th",{className:"py-3 px-2 md text-left",children:e("span",{className:"ml-2",children:"No"})}),e("th",{className:"py-3 px-4 text-left",children:e("span",{className:"sm:ml-8 md:ml-10 lg:ml-12",children:"Nama Jadwal"})}),e("th",{className:"py-3 px-4 text-left hidden sm:table-cell",children:"Hari"}),e("th",{className:"py-3 px-4 text-left hidden md:table-cell",children:"Waktu Siaran"}),e("th",{className:"py-3 px-4 text-left hidden lg:table-cell",children:"Dibuat Oleh"}),e("th",{className:"py-3 px-4 text-left",children:"Aksi"})]})}),e("tbody",{className:"divide-y divide-gray-200",children:!(s!=null&&s.data)||s.data.length===0?e("tr",{children:e("td",{colSpan:6,className:"py-4 text-center text-gray-500",children:"No schedules found."})}):s.data.map((t,a)=>n(v.Fragment,{children:[n("tr",{className:"hover:bg-gray-50",children:[n("td",{className:"py-3 px-4 flex items-center gap-4",children:[e("span",{className:"w-2",children:a+1}),e("img",{src:t.image?`/storage/${t.image}`:"/assets/images/content.webp",alt:t.name,className:"h-16 object-contain rounded"})]}),e("td",{className:"py-2 px-4",children:e("span",{className:"sm:ml-8 md:ml-10 lg:ml-12",children:t.name})}),e("td",{className:"py-2 px-4 hidden sm:table-cell",children:t.date}),n("td",{className:"py-2 px-4 hidden md:table-cell",children:[t.time," WIB"]}),e("td",{className:"py-2 px-4 hidden lg:table-cell",children:t.created_by}),n("td",{className:"py-4 px-4 flex items-center space-x-2",children:[e("button",{onClick:()=>U(t),className:"text-blue-600 hover:text-blue-800 focus:outline-none",children:e(q,{size:20})}),e("button",{onClick:()=>V(t.id),className:"text-red-600 hover:text-red-800 focus:outline-none",children:e(A,{size:20})}),e("div",{className:"lg:hidden mt-2",children:e("button",{onClick:()=>R(a),className:"text-gray-600 hover:text-gray-800 focus:outline-none",children:N===a?e(Y,{size:20}):e(G,{size:20})})})]})]}),N===a&&e("tr",{children:e("td",{colSpan:6,className:"py-3 px-4 lg:hidden",children:n("div",{className:"flex flex-col space-y-2",children:[n("div",{className:"block sm:hidden md:hidden",children:[e("span",{className:"font-semibold",children:"Hari: "}),t.date]}),n("div",{className:"block md:hidden lg:hidden",children:[e("span",{className:"font-semibold",children:"Waktu Siaran: "}),t.time," WIB"]}),n("div",{children:[e("span",{className:"font-semibold",children:"Dibuat Oleh: "}),t.created_by]})]})})})]},t.id))})]})}),n("div",{className:"flex flex-col sm:flex-row items-center sm:justify-between gap-4 mt-2",children:[n("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[n("span",{children:["Showing ",s==null?void 0:s.from," to ",s==null?void 0:s.to," of ",s==null?void 0:s.total," entries"]}),n("select",{className:"form-select form-select-sm text-white-dark w-auto pr-6",value:s==null?void 0:s.per_page,onChange:t=>w(a=>{const l=new URL(a);return l.searchParams.set("per_page",t.target.value),l.searchParams.set("page","1"),l.toString()}),children:[e("option",{value:"10",children:"10"}),e("option",{value:"25",children:"25"}),e("option",{value:"50",children:"50"}),e("option",{value:"100",children:"100"})]})]}),e("ul",{className:"flex items-center space-x-1 rtl:space-x-reverse",children:s==null?void 0:s.links.map((t,a)=>e("li",{children:e("button",{type:"button",onClick:()=>t.url&&w(t.url),className:`flex justify-center font-semibold px-3.5 py-2 rounded-full transition ${t.active?"bg-primary text-white dark:text-white-light dark:bg-primary":"bg-white-light text-dark hover:text-white hover:bg-primary dark:text-white-light dark:bg-[#191e3a] dark:hover:bg-primary"}`,dangerouslySetInnerHTML:{__html:t.label}})},a))})]}),e(T,{appear:!0,show:E,as:v.Fragment,children:n(L,{as:"div",open:E,onClose:S,children:[e(T.Child,{as:v.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0"})}),e("div",{className:"fixed inset-0 z-[999] overflow-y-auto bg-[black]/60",children:e("div",{className:"flex min-h-screen items-center justify-center px-4",children:e(T.Child,{as:v.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:n(L.Panel,{as:"div",className:"panel my-8 w-full max-w-lg overflow-hidden rounded-lg border-0 p-0 text-black dark:text-white-dark",children:[e("div",{className:"flex items-center justify-between bg-[#fbfbfb] px-5 py-3 dark:bg-[#121c2c]",children:e("h5",{className:"text-lg font-bold",children:c?"Edit Jadwal":"Tambah Jadwal Baru"})}),n("form",{onSubmit:K,className:"p-4 text-sm",children:[n("div",{className:"mb-4",children:[e("label",{htmlFor:"name",children:"Nama Jadwal"}),e("input",{type:"text",id:"name",name:"name",required:!0,value:d.name,onChange:W,placeholder:"Masukkan Nama Jadwal",className:"form-input"})]}),n("div",{className:"mb-4",children:[e("label",{htmlFor:"date",children:"Hari"}),n("select",{id:"date",name:"date",required:!0,value:d.date,onChange:I,className:"form-input",children:[e("option",{value:"",children:"Pilih Hari"}),e("option",{value:"Senin",children:"Senin"}),e("option",{value:"Selasa",children:"Selasa"}),e("option",{value:"Rabu",children:"Rabu"}),e("option",{value:"Kamis",children:"Kamis"}),e("option",{value:"Jumat",children:"Jumat"}),e("option",{value:"Sabtu",children:"Sabtu"}),e("option",{value:"Minggu",children:"Minggu"})]})]}),n("div",{className:"mb-4",children:[e("label",{htmlFor:"time",children:"Jam"}),n("div",{className:"flex items-center space-x-2",children:[e("input",{type:"text",id:"startTime",name:"startTime",required:!0,value:c?$():void 0,onChange:j,onKeyDown:F,onBlur:P,className:"form-input",placeholder:"HH:mm",maxLength:5,minLength:5}),e("span",{className:"text-gray-700",children:"-"}),e("input",{type:"text",id:"endTime",name:"endTime",required:!0,value:c?z():void 0,onChange:j,onKeyDown:F,onBlur:P,className:"form-input",placeholder:"HH:mm",maxLength:5,minLength:5})]})]}),n("div",{className:"mb-4",children:[e("label",{htmlFor:"image",children:"Gambar (optional)"}),e("input",{type:"file",id:"image",accept:"image/*",onChange:O,className:"form-input"}),n("p",{className:"text-red-600 mt-1 text-xs",children:[" ",c?"*Upload the image if you want to change your image":""]})]}),n("div",{className:"flex justify-end",children:[e("button",{type:"button",className:"mr-2 px-4 py-2 text-gray-600 bg-gray-200 rounded-md",onClick:S,children:"Batal"}),e("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700",children:c?"Simpan Perubahan":"Simpan"})]})]})]})})})})]})})]})]})};export{ee as default};
