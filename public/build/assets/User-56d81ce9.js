import{r as s,a as h,j as a,b as e,R as g,S as o}from"./main-0ef92fc4.js";import{H as A,a as H,b as I,c as O}from"./index-8e00322f.js";import{z as v,y as U}from"./dialog-b10a86f8.js";const $=()=>{const[k,x]=s.useState(()=>{const t=new URL(window.location.href);return t.pathname="/api/users",t.toString()}),[l,j]=s.useState(null),[b,M]=s.useState(null),[C,y]=s.useState(!1),[c,w]=s.useState(!1),[S,B]=s.useState(null),[m,u]=s.useState({fullName:"",email:"",username:"",password:"",image:null});s.useEffect(()=>{(async()=>{if(!(await h.get("/api/auth-check")).data.authenticated){window.location.href="/login";return}})(),E()},[k]);const E=async()=>{try{const t=await h.get(k);j(t.data)}catch(t){console.error("Error fetching users:",t)}},T=t=>{M(b===t?null:t)},N=()=>{y(!1),w(!1),B(null),u({fullName:"",email:"",username:"",password:"",image:null})},p=t=>{const{name:r,value:n}=t.target;u(d=>({...d,[r]:n}))},D=t=>{const r=t.target.files;r&&r.length>0?u(n=>({...n,image:r[0]})):u(n=>({...n,image:null}))},L=async t=>{t.preventDefault();const{fullName:r,email:n,username:d,password:_,image:F}=m,P={full_name:r,email:n,username:d,password:_};try{const i=new FormData;if(Object.keys(P).forEach(f=>{i.append(f,P[f])}),F&&i.append("image",F),console.log(i),c&&S)try{await h.post(`/api/users/${S.id}/update`,i),await o.fire({icon:"success",title:"Success",text:"User updated successfully!",timer:2e3,confirmButtonColor:"#3085d6"})}catch{await o.fire({icon:"error",title:"Error",text:"Could not update the user. Please try again.",timer:2e3,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"})}else try{await h.post("/api/users",i),await o.fire({icon:"success",title:"Success",text:"User created successfully!",timer:2e3,confirmButtonColor:"#3085d6"})}catch{await o.fire({icon:"error",title:"Error",text:"Could not save user. Please try again.",timer:2e3,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"})}E(),N()}catch(i){console.error("Error saving user:",i)}},R=t=>{B(t),u({fullName:t.full_name,email:t.email,username:t.username,password:"",image:null}),w(!0),y(!0)},z=async t=>{if((await o.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"})).isConfirmed)try{await h.delete(`/api/users/${t}`),x(n=>{const d=new URL(n);return d.searchParams.set("page","1"),d.toString()}),await o.fire({icon:"success",title:"Deleted!",text:"Your user has been deleted.",timer:2e3,confirmButtonColor:"#3085d6"})}catch(n){console.error("Error deleting schedule:",n),await o.fire({icon:"error",title:"Error",text:"Could not delete user. Please try again.",timer:2e3,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"})}};return a("div",{className:"p-4 flex flex-col overflow-hidden",children:[e("nav",{className:"text-gray-500 mb-4","aria-label":"Breadcrumb",children:a("ol",{className:"flex text-gray-500 font-semibold dark:text-white-dark",children:[e("li",{children:e("button",{className:"hover:text-gray-500/70 dark:hover:text-white-dark/70",children:a("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",children:[e("circle",{cx:"9",cy:"6",r:"4",stroke:"currentColor",strokeWidth:"1.5"}),e("path",{opacity:"0.5",d:"M12.5 4.3411C13.0375 3.53275 13.9565 3 15 3C16.6569 3 18 4.34315 18 6C18 7.65685 16.6569 9 15 9C13.9565 9 13.0375 8.46725 12.5 7.6589",stroke:"currentColor",strokeWidth:"1.5"}),e("ellipse",{cx:"9",cy:"17",rx:"7",ry:"4",stroke:"currentColor",strokeWidth:"1.5"}),e("path",{opacity:"0.5",d:"M18 14C19.7542 14.3847 21 15.3589 21 16.5C21 17.5293 19.9863 18.4229 18.5 18.8704",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})})}),e("li",{className:"before:content-['/'] before:px-1.5",children:e("button",{type:"button",children:"Data Pengguna"})})]})}),a("div",{className:"container mx-auto py-1 px-4 sm:px-0",children:[e("button",{className:"flex items-center justify-center mb-2 px-2 py-2 text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200 ease-in-out",onClick:()=>{w(!1),y(!0)},children:"Tambah Pengguna"}),e("div",{className:"overflow-x-auto shadow-md rounded-lg border border-white-light/40 dark:border-[#191e3a]",children:a("table",{className:"min-w-full table-auto table-hover",children:[e("thead",{children:a("tr",{children:[e("th",{className:"py-3 px-4 text-left",children:"No"}),e("th",{className:"py-3 px-4 text-left",children:"Nama"}),e("th",{className:"py-3 px-4 text-left hidden sm:table-cell",children:"Username"}),e("th",{className:"py-3 px-4 text-left hidden md:table-cell",children:"Email"}),e("th",{className:"py-3 px-4 text-left hidden lg:table-cell",children:"Status"}),e("th",{className:"py-3 px-4 text-left",children:"Aksi"})]})}),e("tbody",{children:!(l!=null&&l.data)||l.data.length===0?e("tr",{children:e("td",{colSpan:6,className:"py-4 text-center text-gray-500",children:"No users found."})}):l.data.map((t,r)=>a(g.Fragment,{children:[a("tr",{children:[e("td",{className:"py-2 px-4",children:r+1}),e("td",{className:"py-2 px-4",children:t.full_name}),e("td",{className:"py-2 px-4 hidden sm:table-cell",children:t.username}),e("td",{className:"py-2 px-4 hidden md:table-cell",children:t.email}),e("td",{className:"py-2 px-4 hidden lg:table-cell",children:t.status?e("span",{className:"text-green-600 font-semibold",children:"Active"}):e("span",{className:"text-red-600 font-semibold",children:"Inactive"})}),a("td",{className:"py-4 px-4 flex items-center space-x-2",children:[e("button",{onClick:()=>R(t),className:"text-blue-600 hover:text-blue-800 focus:outline-none",children:e(A,{size:20})}),e("button",{onClick:()=>z(t.id),className:"text-red-600 hover:text-red-800 focus:outline-none",children:e(H,{size:20})}),e("div",{className:"lg:hidden mt-2",children:e("button",{onClick:()=>T(r),className:"text-gray-600 hover:text-gray-800 focus:outline-none",children:b===r?e(I,{size:20}):e(O,{size:20})})})]})]}),b===r&&e("tr",{children:e("td",{colSpan:6,className:"py-3 px-4 lg:hidden",children:a("div",{className:"flex flex-col space-y-2",children:[a("div",{className:"block sm:hidden md:hidden",children:[e("span",{className:"font-semibold",children:"Username: "}),t.username]}),a("div",{className:"block md:hidden lg:hidden",children:[e("span",{className:"font-semibold",children:"Email: "}),t.email]}),a("div",{children:[e("span",{className:"font-semibold",children:"Status: "}),t.status?e("span",{className:"text-green-600 font-semibold",children:"Active"}):e("span",{className:"text-red-600 font-semibold",children:"Inactive"})]})]})})})]},t.id))})]})}),a("div",{className:"flex flex-col sm:flex-row items-center sm:justify-between gap-4 mt-2",children:[a("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[a("span",{children:["Showing ",l==null?void 0:l.from," to ",l==null?void 0:l.to," of ",l==null?void 0:l.total," entries"]}),a("select",{className:"form-select form-select-sm text-white-dark w-auto pr-6",value:l==null?void 0:l.per_page,onChange:t=>x(r=>{const n=new URL(r);return n.searchParams.set("per_page",t.target.value),n.searchParams.set("page","1"),n.toString()}),children:[e("option",{value:"10",children:"10"}),e("option",{value:"25",children:"25"}),e("option",{value:"50",children:"50"}),e("option",{value:"100",children:"100"})]})]}),e("ul",{className:"flex items-center space-x-1 rtl:space-x-reverse",children:l==null?void 0:l.links.map((t,r)=>e("li",{children:e("button",{type:"button",onClick:()=>t.url&&x(t.url),className:`flex justify-center font-semibold px-3.5 py-2 rounded-full transition ${t.active?"bg-primary text-white dark:text-white-light dark:bg-primary":"bg-white-light text-dark hover:text-white hover:bg-primary dark:text-white-light dark:bg-[#191e3a] dark:hover:bg-primary"}`,dangerouslySetInnerHTML:{__html:t.label}})},r))})]}),e(v,{appear:!0,show:C,as:g.Fragment,children:a(U,{as:"div",open:C,onClose:N,children:[e(v.Child,{as:g.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0"})}),e("div",{className:"fixed inset-0 z-[999] overflow-y-auto bg-[black]/60",children:e("div",{className:"flex min-h-screen items-center justify-center px-4",children:e(v.Child,{as:g.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:a(U.Panel,{as:"div",className:"panel my-8 w-full max-w-lg overflow-hidden rounded-lg border-0 p-0 text-black dark:text-white-dark",children:[e("div",{className:"flex items-center justify-between bg-[#fbfbfb] px-5 py-3 dark:bg-[#121c2c]",children:e("h5",{className:"text-lg font-bold",children:c?"Edit Pengguna":"Tambah Pengguna Baru"})}),a("form",{onSubmit:L,className:"p-4 text-sm",children:[a("div",{className:"mb-4",children:[e("label",{htmlFor:"fullName",children:"Nama Lengkap"}),e("input",{type:"text",id:"fullName",name:"fullName",required:!0,value:m.fullName,onChange:p,placeholder:"Masukkan Nama Lengkap",className:"form-input"})]}),a("div",{className:"mb-4",children:[e("label",{htmlFor:"email",children:"Email"}),e("input",{type:"email",id:"email",name:"email",required:!0,value:m.email,onChange:p,placeholder:"Masukkan Email",className:"form-input"})]}),a("div",{className:"mb-4",children:[e("label",{htmlFor:"username",children:"Username"}),e("input",{type:"text",id:"username",name:"username",required:!0,value:m.username,onChange:p,placeholder:"Masukkan Username",className:"form-input"})]}),a("div",{className:"mb-4",children:[e("label",{htmlFor:"password",children:"Password"}),e("input",{type:"password",id:"password",name:"password",required:!c,value:m.password,onChange:p,placeholder:"Masukkan Password",className:"form-input"}),a("p",{className:"text-red-600 mt-1 text-xs",children:[" ",c?"*Fill this field if you want change your password":""]})]}),a("div",{className:"mb-4",children:[e("label",{htmlFor:"image",children:"Unggah Gambar (Opsional)"}),e("input",{type:"file",id:"image",accept:"image/*",onChange:D,className:"form-input"}),a("p",{className:"text-red-600 mt-1 text-xs",children:[" ",c?"*Upload the image if you want to change your image":""]})]}),a("div",{className:"flex justify-end",children:[e("button",{type:"button",className:"mr-2 px-4 py-2 text-gray-600 bg-gray-200 rounded-md",onClick:N,children:"Batal"}),e("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700",children:c?"Simpan Perubahan":"Simpan"})]})]})]})})})})]})})]})]})};export{$ as default};
